<html lang="id">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>Pinterest Pro Clone</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css">
    
    <style>
        :root {
            --bg: #ffffff;
            --text: #111111;
            --gray: #efefef;
            --subtext: #767676;
            --accent: #e60023;
        }

        @media (prefers-color-scheme: dark) {
            :root {
                --bg: #111111;
                --text: #ffffff;
                --gray: #262626;
                --subtext: #b2b2b2;
            }
        }

        * { 
            margin: 0; 
            padding: 0; 
            box-sizing: border-box; 
            font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, sans-serif; 
        }

        body { 
            background: var(--bg); 
            color: var(--text); 
            transition: background 0.3s; 
            -webkit-tap-highlight-color: transparent;
        }

        /* --- HALAMAN LOGIN --- */
        #auth-page { 
            position: fixed; inset: 0; background: var(--bg); 
            z-index: 9999; display: flex; align-items: center; 
            justify-content: center; padding: 30px; 
        }
        .auth-card { text-align: center; width: 100%; max-width: 320px; }
        .auth-logo { color: var(--accent); font-size: 45px; margin-bottom: 10px; }
        .auth-input { 
            width: 100%; padding: 12px; margin-bottom: 8px; 
            border-radius: 12px; border: 1.5px solid var(--gray); 
            background: var(--bg); color: var(--text); outline: none; 
        }

        .navbar { 
            position: fixed; top: 0; width: 100%; height: 60px; 
            background: var(--bg); display: none; align-items: center; 
            padding: 0 15px; z-index: 5000; border-bottom: 1px solid var(--gray);
        }
        .search-bar { 
            flex: 1; background: var(--gray); border-radius: 20px; 
            padding: 8px 15px; display: flex; align-items: center; margin: 0 10px; 
        }
        .search-bar input { 
            border: none; background: transparent; width: 100%; 
            outline: none; color: var(--text); margin-left: 8px; 
        }

        .page { display: none; padding-top: 70px; padding-bottom: 90px; }
        .page.active { display: block; }
        .pin-container { width: 98%; margin: auto; column-count: 2; column-gap: 8px; }
        @media (min-width: 768px) { .pin-container { column-count: 5; } }

        .card { 
            display: inline-block; width: 100%; margin-bottom: 8px; 
            border-radius: 14px; overflow: hidden; background: var(--gray); 
            break-inside: avoid; cursor: pointer;
        }
        .card img { width: 100%; display: block; }

        .toolbar { 
            position: fixed; bottom: 20px; left: 50%; transform: translateX(-50%); 
            background: var(--bg); display: none; gap: 40px; padding: 12px 35px; 
            border-radius: 40px; box-shadow: 0 8px 25px rgba(0,0,0,0.2); 
            z-index: 6000; border: 1px solid var(--gray); 
        }
        .toolbar i { font-size: 22px; color: var(--subtext); cursor: pointer; }
        .toolbar i.active { color: var(--text); }

        .pfp-sync { 
            border-radius: 50%; background-size: cover; 
            background-position: center; flex-shrink: 0; 
            background-color: var(--gray);
        }
        .pfp-nav { width: 26px; height: 26px; border: 1.5px solid transparent; }
        .active-pfp { border-color: var(--text); }

        .modal { 
            display: none; position: fixed; inset: 0; 
            background: rgba(0,0,0,0.9); z-index: 9999; 
            justify-content: center; align-items: center; 
        }
        .modal-content { 
            background: var(--bg); border-radius: 25px; width: 450px; 
            max-width: 95%; height: 85vh; overflow: hidden; display: flex; flex-direction: column; 
        }
        #modal-img { width: 100%; height: 45%; object-fit: cover; }
        .modal-body { flex: 1; padding: 15px; display: flex; flex-direction: column; overflow: hidden; }

        .btn-red { 
            background: var(--accent); color: #fff; border: none; 
            padding: 10px 20px; border-radius: 20px; font-weight: 700; cursor: pointer; 
        }
        .icon-btn { font-size: 20px; cursor: pointer; color: var(--text); }
        .fa-heart.liked { color: var(--accent); }

        .comment-section { 
            flex: 1; overflow-y: auto; margin: 10px 0; 
            border-top: 1px solid var(--gray); padding-top: 10px; 
        }
        .comment-item { display: flex; gap: 10px; margin-bottom: 12px; font-size: 13px; align-items: flex-start; }
    </style>
</head>
<body>

    <div id="auth-page">
        <div class="auth-card">
            <i class="fab fa-pinterest auth-logo"></i>
            <h2 style="margin-bottom: 20px;">Masuk</h2>
            <input type="email" id="auth-email" class="auth-input" placeholder="Email">
            <input type="password" id="auth-pass" class="auth-input" placeholder="Password">
            <input type="text" id="auth-user" class="auth-input" placeholder="Nama Lengkap">
            <button class="btn-red" style="width: 100%;" onclick="handleAuth()">Lanjutkan</button>
            <div style="margin: 15px; font-size: 12px; color: var(--subtext);">ATAU</div>
            <button style="width: 100%; padding: 10px; border-radius: 20px; border: 1px solid var(--gray); background: var(--bg); color: var(--text); font-weight: 600; cursor: pointer;" onclick="handleAuth('Google User')">
                <img src="https://ik.imagekit.io/Kenzo/IMG_20251226_162306.jpg" width="14" style="vertical-align: middle; margin-right: 5px;"> Google
            </button>
        </div>
    </div>

    <nav class="navbar" id="main-nav">
        <div style="color:var(--accent); font-size:24px;"><i class="fab fa-pinterest"></i></div>
        <div class="search-bar">
            <i class="fa fa-search" style="color: var(--subtext);"></i>
            <input type="text" placeholder="Cari inspirasi...">
        </div>
    </nav>

    <main id="home-page" class="page active">
        <div class="pin-container" id="home-grid"></div>
    </main>
    
    <div id="upload-page" class="page">
        <div style="max-width: 350px; margin: auto; padding: 20px; text-align: center;">
            <div style="border: 2px dashed var(--gray); padding: 50px; border-radius: 20px; cursor: pointer;" onclick="document.getElementById('file-up').click()">
                <i class="fa fa-cloud-upload-alt" style="font-size: 40px; color: var(--gray);"></i>
                <img id="up-prev" style="display:none; width:100%; border-radius:12px; margin-top: 15px;">
                <input type="file" id="file-up" hidden accept="image/*">
            </div>
            <button class="btn-red" style="width: 100%; margin-top: 20px;" onclick="handleUpload()">Upload Pin</button>
        </div>
    </div>

    <div id="profile-page" class="page">
        <div style="text-align: center; padding: 20px;">
            <div class="pfp-sync" id="pfp-main-view" style="width: 100px; height: 100px; margin: 0 auto 10px; cursor: pointer;" onclick="document.getElementById('pfp-change').click()"></div>
            <input type="file" id="pfp-change" hidden accept="image/*">
            <h2 id="display-name">User</h2>
            <button style="margin-top: 10px; background: none; border: 1px solid var(--gray); color: var(--text); padding: 5px 15px; border-radius: 20px; font-size: 12px; cursor: pointer;" onclick="logout()">Keluar</button>
            <div style="display: flex; justify-content: center; gap: 20px; margin-top: 20px; font-weight: 600;">
                <span onclick="switchTab('pins')" id="tab-pins" style="cursor:pointer; color: var(--text);">Dibuat</span>
                <span onclick="switchTab('saved')" id="tab-saved" style="cursor:pointer; color: var(--subtext);">Disimpan</span>
            </div>
        </div>
        <div class="pin-container" id="profile-grid"></div>
    </div>

    <div class="toolbar" id="main-toolbar">
        <i class="fa fa-home active" id="ic-home" onclick="showPage('home')"></i>
        <i class="fa fa-plus-circle" id="ic-upload" onclick="showPage('upload')"></i>
        <div class="pfp-nav pfp-sync" id="ic-profile" onclick="showPage('profile')"></div>
    </div>

    <div id="modal-box" class="modal">
        <div class="modal-content">
            <img id="modal-img" src="">
            <div class="modal-body">
                <div style="display: flex; justify-content: space-between; align-items: center; padding-bottom: 10px;">
                    <div style="display: flex; gap: 20px;">
                        <i class="fa fa-heart icon-btn far" id="like-btn" onclick="toggleLike()"></i>
                        <i class="fa fa-download icon-btn" onclick="downloadImg()"></i>
                    </div>
                    <button class="btn-red" onclick="savePin()">Simpan</button>
                </div>
                <div class="comment-section" id="comment-list"></div>
                <div style="display: flex; gap: 10px; align-items: center;">
                    <div class="pfp-sync" style="width: 28px; height: 28px;"></div>
                    <input type="text" id="input-comm" style="flex:1; padding: 10px; border-radius: 20px; border: 1px solid var(--gray); background: var(--gray); color: var(--text); outline: none;" placeholder="Tulis komentar...">
                    <i class="fa fa-paper-plane" onclick="sendComment()" style="color: var(--accent); cursor: pointer;"></i>
                </div>
            </div>
        </div>
    </div>

    <script>
        let currentImg = "";
        let currentTab = "pins";

        function handleAuth(name = null) {
            const user = name || document.getElementById('auth-user').value;
            if(!user) return alert("Silakan isi nama Anda!");
            
            localStorage.setItem('pin_logged', 'true');
            localStorage.setItem('pin_name', user);
            
            if(!localStorage.getItem('pin_pfp')) {
                localStorage.setItem('pin_pfp', 'https://i.pravatar.cc/150?u=' + user);
            }
            init();
        }

        function logout() {
            if(confirm("Yakin ingin keluar?")) {
                localStorage.clear();
                location.reload();
            }
        }

        function init() {
            if(localStorage.getItem('pin_logged') !== 'true') return;
            
            document.getElementById('auth-page').style.display = 'none';
            document.getElementById('main-nav').style.display = 'flex';
            document.getElementById('main-toolbar').style.display = 'flex';
            document.getElementById('display-name').innerText = localStorage.getItem('pin_name');
            
            updatePFP();
            renderHome();
            renderProfile();
        }

        function updatePFP() {
            const pfp = localStorage.getItem('pin_pfp');
            document.querySelectorAll('.pfp-sync').forEach(el => {
                el.style.backgroundImage = `url(${pfp})`;
            });
        }

        function renderHome() {
            const grid = document.getElementById('home-grid');
            grid.innerHTML = "";
            for(let i=0; i<30; i++) {
                const url = `https://picsum.photos/400/${400 + (i%5)*40}?random=${i}`;
                grid.appendChild(createCard(url));
            }
        }

        function createCard(url) {
            const div = document.createElement('div');
            div.className = 'card';
            div.innerHTML = `<img src="${url}" loading="lazy">`;
            div.onclick = () => {
                currentImg = url;
                document.getElementById('modal-box').style.display = 'flex';
                document.getElementById('modal-img').src = url;
                checkLikeStatus();
                loadComments();
            };
            return div;
        }

        // --- FITUR LIKE & DOWNLOAD ---
        function downloadImg() {
            const link = document.createElement('a');
            link.href = currentImg;
            link.download = 'Pinterest_Clone_Image.jpg';
            document.body.appendChild(link);
            link.click();
            document.body.removeChild(link);
        }

        function toggleLike() {
            let likes = JSON.parse(localStorage.getItem('pin_likes') || "[]");
            if(likes.includes(currentImg)) {
                likes = likes.filter(l => l !== currentImg);
            } else {
                likes.push(currentImg);
            }
            localStorage.setItem('pin_likes', JSON.stringify(likes));
            checkLikeStatus();
        }

        function checkLikeStatus() {
            let likes = JSON.parse(localStorage.getItem('pin_likes') || "[]");
            const btn = document.getElementById('like-btn');
            if(likes.includes(currentImg)) {
                btn.className = "fa fa-heart icon-btn liked fas";
            } else {
                btn.className = "fa fa-heart icon-btn far";
            }
        }

        function sendComment() {
            const inp = document.getElementById('input-comm');
            if(!inp.value.trim()) return;

            let comms = JSON.parse(localStorage.getItem('pin_comments') || "[]");
            comms.push({
                img: currentImg,
                user: localStorage.getItem('pin_name'),
                pfp: localStorage.getItem('pin_pfp'),
                text: inp.value
            });

            localStorage.setItem('pin_comments', JSON.stringify(comms));
            inp.value = "";
            loadComments();
        }

        function loadComments() {
            const list = document.getElementById('comment-list');
            list.innerHTML = "";
            let comms = JSON.parse(localStorage.getItem('pin_comments') || "[]");
            let filtered = comms.filter(c => c.img === currentImg);

            if(filtered.length === 0) {
                list.innerHTML = "<p style='color:var(--subtext); font-size:12px;'>Belum ada komentar.</p>";
            }

            filtered.forEach(c => {
                const item = document.createElement('div');
                item.className = 'comment-item';
                item.innerHTML = `
                    <div class="pfp-sync" style="background-image:url(${c.pfp}); width:25px; height:25px;"></div>
                    <div><b style="font-size:12px;">${c.user}</b><br>${c.text}</div>
                `;
                list.appendChild(item);
            });
        }

        document.getElementById('pfp-change').onchange = (e) => {
            const reader = new FileReader();
            reader.onload = (v) => {
                localStorage.setItem('pin_pfp', v.target.result);
                updatePFP();
            };
            reader.readAsDataURL(e.target.files[0]);
        };

        document.getElementById('file-up').onchange = (e) => {
            const reader = new FileReader();
            reader.onload = (v) => {
                document.getElementById('up-prev').src = v.target.result;
                document.getElementById('up-prev').style.display = 'block';
            };
            reader.readAsDataURL(e.target.files[0]);
        };

        function handleUpload() {
            const src = document.getElementById('up-prev').src;
            if(!src || src.includes('none')) return alert("Pilih gambar dulu!");
            
            let uploaded = JSON.parse(localStorage.getItem('pin_uploaded') || "[]");
            uploaded.unshift(src);
            localStorage.setItem('pin_uploaded', JSON.stringify(uploaded));
            
            alert("Berhasil diunggah!");
            location.reload();
        }

        function savePin() {
            let saved = JSON.parse(localStorage.getItem('pin_saved') || "[]");
            if(!saved.includes(currentImg)) {
                saved.unshift(currentImg);
                localStorage.setItem('pin_saved', JSON.stringify(saved));
                alert("Berhasil disimpan ke profil!");
            } else {
                alert("Pin sudah disimpan sebelumnya.");
            }
            renderProfile();
        }

        function renderProfile() {
            const grid = document.getElementById('profile-grid');
            grid.innerHTML = "";
            let data = (currentTab === 'pins') 
                ? JSON.parse(localStorage.getItem('pin_uploaded') || "[]") 
                : JSON.parse(localStorage.getItem('pin_saved') || "[]");
            
            if(data.length === 0) {
                grid.innerHTML = "<p style='text-align:center; grid-column:1/-1; color:var(--subtext); padding:20px;'>Belum ada apa-apa di sini.</p>";
            }
            data.forEach(url => grid.appendChild(createCard(url)));
        }

        function switchTab(t) {
            currentTab = t;
            document.getElementById('tab-pins').style.color = (t==='pins') ? 'var(--text)' : 'var(--subtext)';
            document.getElementById('tab-saved').style.color = (t==='saved') ? 'var(--text)' : 'var(--subtext)';
            renderProfile();
        }

        function showPage(id) {
            document.querySelectorAll('.page').forEach(p => p.classList.remove('active'));
            document.getElementById(id + '-page').classList.add('active');
            
            document.querySelectorAll('.toolbar i').forEach(i => i.classList.remove('active'));
            document.getElementById('ic-profile').classList.remove('active-pfp');
            
            if(id === 'profile') document.getElementById('ic-profile').classList.add('active-pfp');
            else document.getElementById('ic-' + id).classList.add('active');
            
            window.scrollTo(0,0);
        }

        window.onclick = (e) => {
            if(e.target.className === 'modal') {
                document.getElementById('modal-box').style.display = 'none';
            }
        };

        init();
    </script>
</body>
</html>
  }

        function updatePFP() {
            const pfp = localStorage.getItem('pin_pfp');
            document.querySelectorAll('.pfp-sync').forEach(el => el.style.backgroundImage = `url(${pfp})`);
        }

        function renderHome() {
            const grid = document.getElementById('home-grid');
            grid.innerHTML = "";
            for(let i=0; i<30; i++) {
                const url = `https://picsum.photos/400/${400 + (i%5)*50}?random=${i}`;
                grid.appendChild(createCard(url));
            }
        }

        function createCard(url) {
            const div = document.createElement('div');
            div.className = 'card';
            div.innerHTML = `<img src="${url}" loading="lazy">`;
            div.onclick = () => {
                currentImg = url;
                document.getElementById('modal-box').style.display = 'flex';
                document.getElementById('modal-img').src = url;
                checkLikeStatus();
                loadComments();
            };
            return div;
        }

        function downloadImg() {
            const a = document.createElement('a');
            a.href = currentImg;
            a.download = 'pinterest-style-image.jpg';
            document.body.appendChild(a);
            a.click();
            document.body.removeChild(a);
            alert("Gambar sedang diunduh...");
        }

        function toggleLike() {
            let likes = JSON.parse(localStorage.getItem('pin_likes') || "[]");
            const btn = document.getElementById('like-btn');
            if(likes.includes(currentImg)) {
                likes = likes.filter(l => l !== currentImg);
                btn.classList.remove('liked', 'fas');
                btn.classList.add('far');
            } else {
                likes.push(currentImg);
                btn.classList.add('liked', 'fas');
                btn.classList.remove('far');
            }
            localStorage.setItem('pin_likes', JSON.stringify(likes));
        }

        function checkLikeStatus() {
            let likes = JSON.parse(localStorage.getItem('pin_likes') || "[]");
            const btn = document.getElementById('like-btn');
            if(likes.includes(currentImg)) {
                btn.classList.add('liked', 'fas');
                btn.classList.remove('far');
            } else {
                btn.classList.remove('liked', 'fas');
                btn.classList.add('far');
            }
        }

        function sendComment() {
            const inp = document.getElementById('input-comm');
            if(!inp.value) return;
            let comms = JSON.parse(localStorage.getItem('pin_comments') || "[]");
            comms.push({ img: currentImg, user: localStorage.getItem('pin_name'), pfp: localStorage.getItem('pin_pfp'), text: inp.value });
            localStorage.setItem('pin_comments', JSON.stringify(comms));
            inp.value = ""; loadComments();
        }

        function loadComments() {
            const list = document.getElementById('comment-list');
            list.innerHTML = "";
            let comms = JSON.parse(localStorage.getItem('pin_comments') || "[]");
            comms.filter(c => c.img === currentImg).forEach(c => {
                const d = document.createElement('div');
                d.className = 'comment-item';
                d.innerHTML = `<div class="pfp-sync" style="background-image:url(${c.pfp}); width:25px; height:25px;"></div><div><b>${c.user}</b> ${c.text}</div>`;
                list.appendChild(d);
            });
        }

        document.getElementById('pfp-change').onchange = (e) => {
            const fr = new FileReader();
            fr.onload = (v) => { localStorage.setItem('pin_pfp', v.target.result); updatePFP(); };
            fr.readAsDataURL(e.target.files[0]);
        };

        document.getElementById('file-up').onchange = (e) => {
            const fr = new FileReader();
            fr.onload = (v) => { document.getElementById('up-prev').src = v.target.result; document.getElementById('up-prev').style.display = 'block'; };
            fr.readAsDataURL(e.target.files[0]);
        };

        function handleUpload() {
            const src = document.getElementById('up-prev').src;
            let pins = JSON.parse(localStorage.getItem('pin_uploaded') || "[]");
            pins.unshift(src); localStorage.setItem('pin_uploaded', JSON.stringify(pins));
            location.reload();
        }

        function savePin() {
            let saved = JSON.parse(localStorage.getItem('pin_saved') || "[]");
            if(!saved.includes(currentImg)) { saved.unshift(currentImg); localStorage.setItem('pin_saved', JSON.stringify(saved)); alert("Tersimpan!"); }
        }

        function renderProfile() {
            const grid = document.getElementById('profile-grid'); grid.innerHTML = "";
            let data = (currentTab === 'pins') ? JSON.parse(localStorage.getItem('pin_uploaded') || "[]") : JSON.parse(localStorage.getItem('pin_saved') || "[]");
            data.forEach(u => grid.appendChild(createCard(u)));
        }

        function switchTab(t) {
            currentTab = t;
            document.getElementById('tab-pins').style.color = (t==='pins') ? 'var(--text)' : 'var(--subtext)';
            document.getElementById('tab-saved').style.color = (t==='saved') ? 'var(--text)' : 'var(--subtext)';
            renderProfile();
        }

        function showPage(id) {
            document.querySelectorAll('.page').forEach(p => p.classList.remove('active'));
            document.getElementById(id + '-page').classList.add('active');
            document.querySelectorAll('.toolbar i').forEach(i => i.classList.remove('active'));
            if(id!=='profile') document.getElementById('ic-'+id).classList.add('active');
            window.scrollTo(0,0);
        }

        window.onclick = (e) => { if(e.target.className === 'modal') e.target.style.display = 'none'; };

        init();
    </script>
</body>
</html>
        <div style="max-width: 350px; margin: auto; padding: 20px; text-align: center;">
            <div style="border: 2px dashed var(--gray); padding: 50px; border-radius: 20px; cursor: pointer;" onclick="document.getElementById('file-up').click()">
                <i class="fa fa-cloud-upload-alt" style="font-size: 40px; color: var(--gray);"></i>
                <img id="up-prev" style="display:none; width:100%; border-radius:12px;">
                <input type="file" id="file-up" hidden accept="image/*">
            </div>
            <button class="btn-red" style="width: 100%; margin-top: 20px;" onclick="handleUpload()">Upload Pin</button>
        </div>
    </div>

    <div id="profile-page" class="page">
        <div style="text-align: center; padding: 20px;">
            <div class="pfp-sync" style="width: 100px; height: 100px; margin: 0 auto 10px; cursor: pointer;" onclick="document.getElementById('pfp-change').click()"></div>
            <input type="file" id="pfp-change" hidden accept="image/*">
            <h2 id="display-name">User</h2>
            <button style="margin-top: 10px; background: none; border: 1px solid var(--gray); color: var(--text); padding: 5px 15px; border-radius: 20px; font-size: 12px;" onclick="logout()">Keluar</button>
            <div style="display: flex; justify-content: center; gap: 20px; margin-top: 20px; font-weight: 600;">
                <span onclick="switchTab('pins')" id="tab-pins" style="cursor:pointer;" class="active-tab">Dibuat</span>
                <span onclick="switchTab('saved')" id="tab-saved" style="cursor:pointer; color: var(--subtext);">Disimpan</span>
            </div>
        </div>
        <div class="pin-container" id="profile-grid"></div>
    </div>

    <div class="toolbar" id="main-toolbar">
        <i class="fa fa-home active" id="ic-home" onclick="showPage('home')"></i>
        <i class="fa fa-plus-circle" id="ic-upload" onclick="showPage('upload')"></i>
        <div class="pfp-nav pfp-sync" id="ic-profile" onclick="showPage('profile')"></div>
    </div>

    <div id="modal-box" class="modal">
        <div class="modal-content">
            <img id="modal-img" src="">
            <div class="modal-body">
                <div class="actions">
                    <div style="display: flex; gap: 20px;">
                        <i class="fa fa-heart icon-btn" id="like-btn" onclick="toggleLike()"></i>
                        <i class="fa fa-download icon-btn" onclick="downloadImg()"></i>
                    </div>
                    <button class="btn-red" onclick="savePin()">Simpan</button>
                </div>
                <div class="comment-section" id="comment-list"></div>
                <div style="display: flex; gap: 10px; align-items: center;">
                    <div class="pfp-sync" style="width: 25px; height: 25px;"></div>
                    <input type="text" id="input-comm" style="flex:1; padding: 10px; border-radius: 20px; border: 1px solid var(--gray); background: var(--gray); color: var(--text); outline: none;" placeholder="Komentar...">
                    <i class="fa fa-paper-plane" onclick="sendComment()" style="color: var(--accent);"></i>
                </div>
            </div>
        </div>
    </div>

    <script>
        let currentImg = "";
        let currentTab = "pins";

        function handleAuth(name = null) {
            const user = name || document.getElementById('auth-user').value;
            if(!user) return alert("Isi data dulu!");
            localStorage.setItem('pin_logged', 'true');
            localStorage.setItem('pin_name', user);
            if(!localStorage.getItem('pin_pfp')) localStorage.setItem('pin_pfp', 'https://i.pravatar.cc/150?u='+user);
            init();
        }

        function logout() { localStorage.clear(); location.reload(); }

        function init() {
            if(localStorage.getItem('pin_logged') !== 'true') return;
            document.getElementById('auth-page').style.display = 'none';
            document.getElementById('main-nav').style.display = 'flex';
            document.getElementById('main-toolbar').style.display = 'flex';
            document.getElementById('display-name').innerText = localStorage.getItem('pin_name');
            updatePFP();
            renderHome();
            renderProfile();
        }

        function updatePFP() {
            const pfp = localStorage.getItem('pin_pfp');
            document.querySelectorAll('.pfp-sync').forEach(el => el.style.backgroundImage = `url(${pfp})`);
        }

        function renderHome() {
            const grid = document.getElementById('home-grid');
            grid.innerHTML = "";
            for(let i=0; i<30; i++) {
                const url = `https://picsum.photos/400/${400 + (i%5)*50}?random=${i}`;
                grid.appendChild(createCard(url));
            }
        }

        function createCard(url) {
            const div = document.createElement('div');
            div.className = 'card';
            div.innerHTML = `<img src="${url}" loading="lazy">`;
            div.onclick = () => {
                currentImg = url;
                document.getElementById('modal-box').style.display = 'flex';
                document.getElementById('modal-img').src = url;
                checkLikeStatus();
                loadComments();
            };
            return div;
        }

        function downloadImg() {
            const a = document.createElement('a');
            a.href = currentImg;
            a.download = 'pinterest-style-image.jpg';
            document.body.appendChild(a);
            a.click();
            document.body.removeChild(a);
            alert("Gambar sedang diunduh...");
        }

        function toggleLike() {
            let likes = JSON.parse(localStorage.getItem('pin_likes') || "[]");
            const btn = document.getElementById('like-btn');
            if(likes.includes(currentImg)) {
                likes = likes.filter(l => l !== currentImg);
                btn.classList.remove('liked', 'fas');
                btn.classList.add('far');
            } else {
                likes.push(currentImg);
                btn.classList.add('liked', 'fas');
                btn.classList.remove('far');
            }
            localStorage.setItem('pin_likes', JSON.stringify(likes));
        }

        function checkLikeStatus() {
            let likes = JSON.parse(localStorage.getItem('pin_likes') || "[]");
            const btn = document.getElementById('like-btn');
            if(likes.includes(currentImg)) {
                btn.classList.add('liked', 'fas');
                btn.classList.remove('far');
            } else {
                btn.classList.remove('liked', 'fas');
                btn.classList.add('far');
            }
        }

        function sendComment() {
            const inp = document.getElementById('input-comm');
            if(!inp.value) return;
            let comms = JSON.parse(localStorage.getItem('pin_comments') || "[]");
            comms.push({ img: currentImg, user: localStorage.getItem('pin_name'), pfp: localStorage.getItem('pin_pfp'), text: inp.value });
            localStorage.setItem('pin_comments', JSON.stringify(comms));
            inp.value = ""; loadComments();
        }

        function loadComments() {
            const list = document.getElementById('comment-list');
            list.innerHTML = "";
            let comms = JSON.parse(localStorage.getItem('pin_comments') || "[]");
            comms.filter(c => c.img === currentImg).forEach(c => {
                const d = document.createElement('div');
                d.className = 'comment-item';
                d.innerHTML = `<div class="pfp-sync" style="background-image:url(${c.pfp}); width:25px; height:25px;"></div><div><b>${c.user}</b> ${c.text}</div>`;
                list.appendChild(d);
            });
        }

        document.getElementById('pfp-change').onchange = (e) => {
            const fr = new FileReader();
            fr.onload = (v) => { localStorage.setItem('pin_pfp', v.target.result); updatePFP(); };
            fr.readAsDataURL(e.target.files[0]);
        };

        document.getElementById('file-up').onchange = (e) => {
            const fr = new FileReader();
            fr.onload = (v) => { document.getElementById('up-prev').src = v.target.result; document.getElementById('up-prev').style.display = 'block'; };
            fr.readAsDataURL(e.target.files[0]);
        };

        function handleUpload() {
            const src = document.getElementById('up-prev').src;
            let pins = JSON.parse(localStorage.getItem('pin_uploaded') || "[]");
            pins.unshift(src); localStorage.setItem('pin_uploaded', JSON.stringify(pins));
            location.reload();
        }

        function savePin() {
            let saved = JSON.parse(localStorage.getItem('pin_saved') || "[]");
            if(!saved.includes(currentImg)) { saved.unshift(currentImg); localStorage.setItem('pin_saved', JSON.stringify(saved)); alert("Tersimpan!"); }
        }

        function renderProfile() {
            const grid = document.getElementById('profile-grid'); grid.innerHTML = "";
            let data = (currentTab === 'pins') ? JSON.parse(localStorage.getItem('pin_uploaded') || "[]") : JSON.parse(localStorage.getItem('pin_saved') || "[]");
            data.forEach(u => grid.appendChild(createCard(u)));
        }

        function switchTab(t) {
            currentTab = t;
            document.getElementById('tab-pins').style.color = (t==='pins') ? 'var(--text)' : 'var(--subtext)';
            document.getElementById('tab-saved').style.color = (t==='saved') ? 'var(--text)' : 'var(--subtext)';
            renderProfile();
        }

        function showPage(id) {
            document.querySelectorAll('.page').forEach(p => p.classList.remove('active'));
            document.getElementById(id + '-page').classList.add('active');
            document.querySelectorAll('.toolbar i').forEach(i => i.classList.remove('active'));
            if(id!=='profile') document.getElementById('ic-'+id).classList.add('active');
            window.scrollTo(0,0);
        }

        window.onclick = (e) => { if(e.target.className === 'modal') e.target.style.display = 'none'; };

        init();
    </script>
</body>
</html>
        <div class="profile-header">
            <div id="pfp-big"></div>
            <h2 id="display-name">User Name</h2>
            <button class="btn-edit" onclick="changeName()">Edit Nama</button>
            <button class="btn-edit" onclick="document.getElementById('pfp-inp').click()">Ganti Foto</button>
            <input type="file" id="pfp-inp" hidden accept="image/*">
        </div>
        <div class="pin-container" id="profile-grid"></div>
    </div>

    <div class="toolbar">
        <div onclick="showPage('home')"><i class="fa fa-home" style="font-size: 24px;"></i></div>
        <div onclick="showPage('upload')"><i class="fa fa-plus" style="font-size: 24px;"></i></div>
        <div onclick="showPage('profile')"><div class="pfp-nav pfp-sync"></div></div>
    </div>

    <div id="modal-box" class="modal">
        <div class="modal-content">
            <img id="modal-img" src="">
            <div class="modal-info">
                <h3>Detail Pin</h3>
                <div class="komentar-box" id="list-komentar"></div>
                <button class="btn-red" onclick="document.getElementById('modal-box').style.display='none'">Tutup</button>
            </div>
        </div>
    </div>

    <script>const hGrid = document.getElementById('home-grid');
const pGrid = document.getElementById('profile-grid');
const inpSearch = document.getElementById('inpSearch');
        
function init() {
    const n = localStorage.getItem('wk_name') || "Wak User";
    const p = localStorage.getItem('wk_pfp') || "https://www.w3schools.com/howto/img_avatar.png";
    document.getElementById('display-name').innerText = n;
    document.getElementById('pfp-big').style.backgroundImage = `url(${p})`;
    document.querySelectorAll('.pfp-sync').forEach(el => el.style.backgroundImage = `url(${p})`);
    renderProfile();
    loadRandomHome();
}

function changeName() {
    const n = prompt("Masukkan nama baru:");
    if(n) { localStorage.setItem('wk_name', n); init(); }
}

document.getElementById('pfp-inp').onchange = (e) => {
    const fr = new FileReader();
    fr.onload = (v) => { localStorage.setItem('wk_pfp', v.target.result); init(); };
    fr.readAsDataURL(e.target.files[0]);
};

function createCard(url) {
    const d = document.createElement('div');
    d.className = 'card';
    d.innerHTML = `<img src="${url}" loading="lazy" onerror="this.src='https://picsum.photos/400/600'">`;
    d.onclick = () => {
        document.getElementById('modal-box').style.display = 'flex';
        document.getElementById('modal-img').src = url;
    };
    return d;
}

function loadRandomHome() {
    hGrid.innerHTML = "";
    for(let i=0; i<30; i++) {
        hGrid.appendChild(createCard(`https://picsum.photos/400/${300+i}?random=${Math.random()}`));
    }
}

inpSearch.onkeypress = (e) => {
    if(e.key === 'Enter') {
        const q = inpSearch.value;
        if(!q) return;
        hGrid.innerHTML = "";
        for(let i=0; i<40; i++) {
            const url = `https://images.unsplash.com/photo-1?auto=format&fit=crop&w=400&q=80&keywords=${encodeURIComponent(q)}&sig=${Math.random()+i}`;
            hGrid.appendChild(createCard(url));
        }
        showPage('home');
    }
};

document.getElementById('file-up').onchange = (e) => {
    const fr = new FileReader();
    fr.onload = (v) => {
        document.getElementById('up-prev').src = v.target.result;
        document.getElementById('up-prev').style.display = 'block';
        document.getElementById('up-text').style.display = 'none';
    };
    fr.readAsDataURL(e.target.files[0]);
};

function handleUpload() {
    const src = document.getElementById('up-prev').src;
    if(!src) return alert("Pilih foto!");
    const pins = JSON.parse(localStorage.getItem('wk_pins') || "[]");
    pins.unshift(src);
    localStorage.setItem('wk_pins', JSON.stringify(pins));
    renderProfile();
    showPage('profile');
}

function renderProfile() {
    const pins = JSON.parse(localStorage.getItem('wk_pins') || "[]");
    pGrid.innerHTML = "";
    pins.forEach(u => pGrid.appendChild(createCard(u)));
}

function showPage(id) {
    document.querySelectorAll('.page').forEach(p => p.classList.remove('active'));
    document.getElementById(id + '-page').classList.add('active');
    window.scrollTo(0,0);
}

init();
window.onclick = (e) => { if(e.target.id == 'modal-box') e.target.style.display = 'none'; };
    </script>
</body>
</html>

